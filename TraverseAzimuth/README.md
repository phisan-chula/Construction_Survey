# กริดแอซิมัธและยีออเดติกส์แอซิมัธสำหรับวงรอบ  </br>
# Grid Azimuth and Geodetic Azimuth for Traverse  </br>
   แอซิมัธของวงรอบมักจะคำนวนได้จาก ค่าพิกัดยูทีเอ็มของหมุดควบคุมสำหรับคู่ค่าพิกัดที่ปรากฏเป็นจุดเริ่มและจุดปลายของแขนวงรอบใด หรืออาจคำนวนได้จากวิธี inverse problem ที่ให้ผลค่าแอซิมัธแตกต่างออกไปเนื่องจาก convergence of the meridian ดังแอซิมัธอาจระบุหรือคำนวนด้วย </br>
1) กริดแอซิมัธ (grid azimuth) ที่มุมอ้างอิงจากแกนเหนือของกริดยูทีเอ็ม</br>
2) ยีออเดติกส์แอซิมัธ (geodetic azimuth) ที่มุมอ้างอิงออกจากแนวเมอริเดืยนบนรูปทรงรีโลก </br>
</br>
   โปรแกรม GridGeodLine จะอ่าน CSV ของค่าพิกัดหมุดควบคุม แล้วำคำนวน กริดแอซิมัธพร้อมยีออเดติกส์แอซิมัธ ให้ และยังคำนวนค่าเบี่ยงเบนของสนามแม่เหล็กโลก (magnetic declination) ในโปรแกรมเลือกใช้ แบบจำลองสนามแม่เหล็กโลก (World Magnettic Model 2020, WMM2020).</br>
   ในงานควบคุมตรวจสอบความถูกต้องของงานวงรอบที่อยู่ในพื้นที่อับสัญญาณจีเอนเอสเอส และวงรอบนั้นมีความยาวหลายกิโลเมตร ไม่มีปล่อง (adit, shaft ) เพื่อช่วนในการโยงค่าพิกัดจากผิวดินที่เปิดโล่งรับสัญญาณจากจีเอนเอสเอสได้เลย เช่นวงรอบเดินในอุโมงค์ยาวกว่า 1 กิโลเมตร กรณีนี้จำเป็นต้องใช้เครื่องมือพิเศษที่สามารถหาค่าแอซิมัธอิสระจากสนามแม่เหล็กโลก เช่นเดียวกับเข็มทิศแม่เหล็ก อุปกรณ์ช่วยตรวจสอบหรือบังคับทิศทางแอซิมัธนี้เรียกว่า GyroTheodolite ซึ่งสามารถรังวัด ยีออเดติกส์แอซิมัธได้ความละเอียดถูกต้องสูงถึง 5-30 ฟิลิปดา</br>
</br>
## โปรแกรม GridGeodLine สามารถอ่าน CSV ได้ 2 รูปแบบคือ</br>
</br>
1) CSV ประกอบด้วยชื่อสถานี ระยะเหนือ ระยะตะวันออก ในกรณี โปรแกรมจะคำนวนค่าแก้สนามแม่เหล็กโลก และเลือกใช้เวลาปัจจุบันพร้อมค่าพิกัดนั้นๆ ในการประมาณค่า magnetic declination</br>

|    | STATION   |    Northing |    Easting |
|---:|:----------|------------:|-----------:|
|  0 | PC_25     | 1508190.917 | 667478.344 |
|  1 | PC_26_1   | 1508029.269 | 667119.549 |
|  2 | R1611     | 1508203.943 | 667493.137 |
|  3 | OBS6      | 1508016.330 | 667089.722 |
|  4 | R6        | 1507395.105 | 665784.461 |
|  5 | R176      | 1507479.055 | 665979.979 |
</br>
2) CSV ประกอบด้วยชื่อสถานี ระยะเหนือ ระยะตะวันออก และวันที่ ในกรณี โปรแกรมจะคำนวนค่าแก้สนามแม่เหล็กโลก และเลือกใช้วันที่ตามระบุพร้อมค่าพิกัดนั้นๆ ในการประมาณค่า magnetic declination</br>
</br>

|    | STATION   |    Northing |    Easting | Date       |
|---:|:----------|------------:|-----------:|:-----------|
|  0 | PC_25     | 1508190.917 | 667478.344 | 2023-11-01 |
|  1 | PC_26_1   | 1508029.269 | 667119.549 | 2023-11-01 |
|  2 | R1611     | 1508203.943 | 667493.137 | 2023-11-01 |
|  3 | OBS6      | 1508016.330 | 667089.722 | 2023-11-01 |
|  4 | R6        | 1507395.105 | 665784.461 | 2023-11-01 |
|  5 | R176      | 1507479.055 | 665979.979 | 2023-11-01 |


## การใช้งานโปรแกรม  GridGeodLine.py ตามด้วยชื่อ CSV  ไฟล์จะอ่านเข้า เช่น</br>
python3 GridGeodLine.py MWA_CK_Ctrl_dt.csv</br>
</br>
Reading control file MWA_CK_Ctrl_dt.csv ...</br>

|    | STATION   |    Northing |    Easting | Date       | Decli         |
|---:|:----------|------------:|-----------:|:-----------|:--------------|
|  0 | PC_25     | 1508190.917 | 667478.344 | 2023-09-19 | -00°51′20.12″ |
|  1 | PC_26_1   | 1508029.269 | 667119.549 | 2023-09-19 | -00°51′19.62″ |
|  2 | R1611     | 1508203.943 | 667493.137 | 2023-09-19 | -00°51′20.16″ |
|  3 | OBS6      | 1508016.330 | 667089.722 | 2023-09-19 | -00°51′19.58″ |
|  4 | R6        | 1507395.105 | 665784.461 | 2023-09-19 | -00°51′17.69″ |
|  5 | R176      | 1507479.055 | 665979.979 | 2023-09-19 | -00°51′17.96″ |

|    | STA     | BS    |   gridDist | gridAz         | gridAz_       |   trueDist | trueAz         | trueAz_       |
|---:|:--------|:------|-----------:|:---------------|:--------------|-----------:|:---------------|:--------------|
|  0 | PC_26_1 | PC_25 |    393.528 | 65.746994898°  | 65°44′49.18″  |    393.549 | 66.111336198°  | 66°06′40.81″  |
|  1 | OBS6    | R1611 |    444.907 | 65.058650074°  | 65°03′31.14″  |    444.931 | 65.422926215°  | 65°25′22.53″  |
|  2 | R176    | R6    |    212.779 | 246.762657808° | 246°45′45.57″ |    212.792 | 247.124349941° | 247°07′27.66″ |
</br>
## ข้อสังเกตุ บริเวณตัวอย่างนี้ เส้นวงรอบ | PC_26_1 | PC_25 | มีค่าต่างแอซิมัธจาก 2 ระบบ ประมาณ 21 ฟิลิปดา


## ข้อสังเกตุ เมื่อเวลาเปลี่ยนไป ประมาณ 40 วัน ค่าเบี่ยงเบนแม่เหล็กเปลี่ยนแปลงถึง 16 ฟิลิปดาร ปรากฏในตาราง

|    | STATION   |    Northing |    Easting | Date       | Decli         |
|---:|:----------|------------:|-----------:|:-----------|:--------------|
|  0 | PC_25     | 1508190.917 | 667478.344 | 2023-11-01 | -00°51′36.39″ |
|  1 | PC_26_1   | 1508029.269 | 667119.549 | 2023-11-01 | -00°51′35.89″ |
|  2 | R1611     | 1508203.943 | 667493.137 | 2023-11-01 | -00°51′36.43″ |
|  3 | OBS6      | 1508016.330 | 667089.722 | 2023-11-01 | -00°51′35.85″ |
|  4 | R6        | 1507395.105 | 665784.461 | 2023-11-01 | -00°51′33.94″ |
|  5 | R176      | 1507479.055 | 665979.979 | 2023-11-01 | -00°51′34.21″ |


